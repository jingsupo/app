<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>demo</title>
    <link rel="stylesheet" type="text/css" href="static/css/main.css">
    <link rel="stylesheet" type="text/css" href="static/css/demo.css">
    <link rel="stylesheet" type="text/css" href="static/css/zTreeStyle/zTreeStyle.css">
    <link rel="stylesheet" href="static/layui/css/layui.css"  media="all">
    <script src="static/js/jquery-1.4.4.min.js"></script>
    <script src="static/js/jquery.ztree.core.min.js"></script>
    <script src="static/js/echarts.min.js"></script>
    <script src="static/layui/layui.js"></script>
    <script src="static/js/require.js"></script>
    <script>
        // 配置加载模块
        require.config({
            paths: {
                "underscore": "static/js/underscore-min",
            }
        });
        require(['underscore'], function () {
            //
        });
    </script>
    <script>
        layui.use(['form', 'laydate'], function() {
            let form = layui.form;
            let laydate = layui.laydate;

            laydate.render({
                elem: '#from_time',
                type: 'datetime',
                format: 'yyyyMMddHHmmss'
            });

            laydate.render({
                elem: '#to_time',
                type: 'datetime',
                format: 'yyyyMMddHHmmss'
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            // 初始化隐藏ztree插件
            document.getElementById('treeDemo').style.display='none';
            // 初始化隐藏loading容器
            document.getElementById('loading-image').style.display='none';
            $.ajax({
                url: "/get_db_names",
                type: "POST",
                dataType: "json",
                success: function (data) {
                    let farm = document.getElementById('farm');
                    for (let i=0; i < data.length; i++) {
                        farm.options.add(new Option(data[i], i+1));
                    }
                }
            });
            let date = new Date();
            let Months = date.getMonth() + 1<10 ? '0' + (date.getMonth() + 1):date.getMonth() + 1; //月份从0开始，因此要+1
            let Dates = date.getDate()<10 ? '0' + date.getDate():date.getDate();
            let Hours = date.getHours()<10 ? '0' + date.getHours():date.getHours();
            let Minutes = date.getMinutes()<10 ? '0' + date.getMinutes():date.getMinutes();
            let Seconds = date.getSeconds()<10 ? '0' + date.getSeconds():date.getSeconds();
            let now = date.getFullYear() + Months + Dates + Hours + Minutes + Seconds;
            let from_time = now - 600000000;
            $('#from_time').val(from_time);
            $('#to_time').val(now);
        });
    </script>
    <script>
        $(document).ready(function () {
            // 必须使用#id进行选择才有效果
            $('#farm').change(function () {
                let treeObj = $.fn.zTree.getZTreeObj("treeDemo");
                if (treeObj) {
                    treeObj.destroy()
                }
                let farm_name = $('#farm').find('option:selected').text();
                $.ajax({
                	url: "/farm",
                	type: "POST",
                	data: {'farm_name': farm_name},
                	dataType: "json",
                	success: function (data) {
                	    let wind_turbine = document.getElementById('wind_turbine');
                	    // 默认清空已经存在的项目
                        wind_turbine.options.length = 1;
                        for (let i=0; i < data.length; i++) {
                            wind_turbine.options.add(new Option(data[i], i+1));
                        }
                	    // 默认使序号为1的项目选中
                	    wind_turbine.options[1].selected = true;
                	}
                });
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $("input[name=q]").click(function () {
                var farm_name = $('#farm').find('option:selected').text();
                var wind_turbine_name = $('#wind_turbine').find('option:selected').text();
                var from_time = $('#from_time').val();
                var to_time = $('#to_time').val();
                var from_rotate_speed = $('#from_rotate_speed').find('option:selected').text();
                var to_rotate_speed = $('#to_rotate_speed').find('option:selected').text();
                if (farm_name === '选择风场' || wind_turbine_name === '选择风机') {
                    alert('请先选择相应项目！');
                }
                else {
                    var dataset = {'farm_name': farm_name,
                        'wind_turbine_name': wind_turbine_name,
                        'from_time': from_time,
                        'to_time': to_time,
                        'from_rotate_speed': from_rotate_speed,
                        'to_rotate_speed': to_rotate_speed,
                    };
                    $.ajax({
                        url: "/q",
                        type: "POST",
                        data: dataset,
                        dataType: "json",
                        success: function (data) {
                            var zTreeObj;
                            var setting = {
                                callback: {
                                    onClick: zTreeOnClick
                                },
                                view: {
                                    showLine: false
                                }
                            };
                            var zNodes = [];
                            var child = [];
                            for (var key in data['point_description']) {
                                child.push({name:data['point_description'][key]});
                            }
                            for (var i=0; i < data['sampling_time'].length; i++) {
                                zNodes.push({name:data['sampling_time'][i], open:false, children:child})
                            }
                            function zTreeOnClick(event, treeId, treeNode) {
                                // console.log(treeNode.tId + ", " + treeNode.name);
                                var treeObj = $.fn.zTree.getZTreeObj("treeDemo");
                                // 当前选中节点
                                var sn = treeObj.getSelectedNodes();
                                var html;
                                if (sn[0].hasOwnProperty('children') && sn[0].children.length > 0) {
                                    html = data['rotate_speed'][sn[0].name];
                                }
                                else {
                                    // 选中节点的父节点
                                    var pn = sn[0].getParentNode();
                                    html = data['rotate_speed'][pn.name];
                                }
                                document.getElementById('time_info').innerHTML = '转速：' + html;
                                // 显示time_info容器
                                document.getElementById('time_info').style.display='';
                            }
                            $(document).ready(function(){
                                zTreeObj = $.fn.zTree.init($("#treeDemo"), setting, zNodes);
                            });
                        }
                    });
                    // 显示ztree插件
                    document.getElementById('treeDemo').style.display='';
                }
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $("input[name=tf]").click(function () {
                if (fig1.dispose) {
                    fig1.dispose();
                }
                fig1 = echarts.init(document.getElementById('fig1'), 'white', {renderer: 'canvas'});
                if (fig2.dispose) {
                    fig2.dispose();
                }
                fig2 = echarts.init(document.getElementById('fig2'), 'white', {renderer: 'canvas'});
                var farm_name = $('#farm').find('option:selected').text();
                var wind_turbine_name = $('#wind_turbine').find('option:selected').text();
                var treeObj = $.fn.zTree.getZTreeObj("treeDemo");
                if (farm_name === '选择风场' || wind_turbine_name === '选择风机' || treeObj == null) {
                    alert('请先选择左侧项目！');
                }
                else {
                    // 当前选中节点
                    var sn = treeObj.getSelectedNodes();
                    if (sn.length === 0) {
                        alert('请选择测点！');
                    }
                    else if (sn[0].hasOwnProperty('children') && sn[0].children.length > 0) {
                        alert('请选择子节点！');
                    }
                    else {
                        // 选中节点的父节点
                        var pn = sn[0].getParentNode();
                        var dataset = {'farm_name': farm_name,
                            'wind_turbine_name': wind_turbine_name,
                            'sampling_time': pn['name'],
                            'point': sn[0]['name'],
                        };
                        $.ajax({
                            url: "/tf",
                            type: "POST",
                            data: dataset,
                            dataType: "json",
                            beforeSend: function () {
                                document.getElementById('loading-image').style.display='';
                            },
                            complete: function () {
                                // $('#loading-image').remove();
                                document.getElementById('loading-image').style.display='none';
                            },
                            success: function (data) {
                                var option_ts = {
                                    title: {
                                        text: '时域图'
                                    },
                                    tooltip: {
                                        trigger: 'axis',
                                        triggerOn: 'mousemove|click',
                                    },
                                    xAxis: {
                                        type: 'value',
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    yAxis: {
                                        type: 'value',
                                        boundaryGap: [0, '100%'],
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    series: [{
                                        name: '振动信号',
                                        type: 'line',
                                        lineStyle: {
                                            width: 1
                                        },
                                        showSymbol: false,
                                        hoverAnimation: false,
                                        data: data['time_series']
                                    }],
                                    dataZoom: [{
                                        //
                                    }],
                                    toolbox: { // 工具栏
                                        feature: {
                                            dataZoom: { // 框选缩放功能
                                                show: true, // show为true时，才能触发takeGlobalCursor事件
                                                yAxisIndex: 'none',
                                            },
                                            restore: {
                                                show: true
                                            },
                                            saveAsImage: {
                                                show: true,
                                                type: 'png',
                                            },
                                        }
                                    }
                                };
                                fig1.setOption(option_ts);
                                var option_freq = {
                                    title: {
                                        text: '频域图'
                                    },
                                    tooltip: {
                                        trigger: 'axis',
                                        triggerOn: 'mousemove|click',
                                    },
                                    xAxis: {
                                        type: 'value',
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    yAxis: {
                                        type: 'value',
                                        boundaryGap: [0, '100%'],
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    series: [{
                                        name: '振幅',
                                        type: 'line',
                                        lineStyle: {
                                            width: 1
                                        },
                                        showSymbol: false,
                                        hoverAnimation: true,
                                        data: data['freq']
                                    }],
                                    dataZoom: [{
                                        //
                                    }],
                                    toolbox: { // 工具栏
                                        feature: {
                                            dataZoom: { // 框选缩放功能
                                                show: true, // show为true时，才能触发takeGlobalCursor事件
                                                yAxisIndex: 'none',
                                            },
                                            restore: {
                                                show: true
                                            },
                                            saveAsImage: {
                                                show: true,
                                                type: 'png',
                                            },
                                        }
                                    }
                                };
                                fig2.setOption(option_freq);
                            }
                        });
                    }
                }
            });
        });
	</script>
    <script>
        $(document).ready(function () {
            $("input[name=envelope]").click(function () {
                if (fig3.dispose) {
                    fig3.dispose();
                }
                fig3 = echarts.init(document.getElementById('fig3'), 'white', {renderer: 'canvas'});
                var farm_name = $('#farm').find('option:selected').text();
                var wind_turbine_name = $('#wind_turbine').find('option:selected').text();
                var treeObj = $.fn.zTree.getZTreeObj("treeDemo");
                var low_cutoff = $('#low_cutoff').val();
                var high_cutoff = $('#high_cutoff').val();
                if (farm_name === '选择风场' || wind_turbine_name === '选择风机' || treeObj == null) {
                    alert('请先选择左侧项目！');
                }
                else {
                    // 当前选中节点
                    var sn = treeObj.getSelectedNodes();
                    if (sn.length === 0) {
                        alert('请选择测点！');
                    }
                    else if (sn[0].hasOwnProperty('children') && sn[0].children.length > 0) {
                        alert('请选择子节点！');
                    }
                    else {
                        // 选中节点的父节点
                        var pn = sn[0].getParentNode();
                        var dataset = {'farm_name': farm_name,
                            'wind_turbine_name': wind_turbine_name,
                            'sampling_time': pn['name'],
                            'point': sn[0]['name'],
                            'low_cutoff': low_cutoff,
                            'high_cutoff': high_cutoff,
                        };
                        $.ajax({
                            url: "/envelope",
                            type: "POST",
                            data: dataset,
                            dataType: "json",
                            beforeSend: function () {
                                document.getElementById('loading-image').style.display='';
                            },
                            complete: function () {
                                document.getElementById('loading-image').style.display='none';
                            },
                            success: function (data) {
                                var option_envelope = {
                                    title: {
                                        text: '包络图'
                                    },
                                    tooltip: {
                                        trigger: 'axis',
                                        triggerOn: 'mousemove|click',
                                        // formatter : function (params) {
                                        //     console.log(params[0].value);
                                        // },
                                        // backgroundColor: "gray",
                                        position: function (point, params, dom, rect, size) {
                                            // 鼠标坐标和提示框位置的参考坐标系是：以外层div的左上角那一点为原点，x轴向右，y轴向下
                                            // 提示框位置
                                            var x = 0; // x坐标位置
                                            var y = 0; // y坐标位置

                                            // 当前鼠标位置
                                            var pointX = point[0];
                                            var pointY = point[1];

                                            // 外层div大小
                                            // var viewWidth = size.viewSize[0];
                                            // var viewHeight = size.viewSize[1];

                                            // 提示框大小
                                            var boxWidth = size.contentSize[0];
                                            var boxHeight = size.contentSize[1];

                                            // boxWidth > pointX 说明鼠标左边放不下提示框
                                            if (boxWidth > pointX) {
                                            x = 5;
                                            } else { // 左边放的下
                                            x = pointX;
                                            }

                                            // boxHeight > pointY 说明鼠标上边放不下提示框
                                            if (boxHeight > pointY) {
                                            y = 5;
                                            } else { // 上边放得下
                                            y = pointY;
                                            }

                                            return [x, y];
                                        },
                                    },
                                    xAxis: {
                                        type: 'value',
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    yAxis: {
                                        type: 'value',
                                        boundaryGap: [0, '100%'],
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    series: [{
                                        name: '振幅',
                                        type: 'line',
                                        lineStyle: {
                                            width: 1
                                        },
                                        showSymbol: false,
                                        hoverAnimation: true,
                                        data: data['envelope']
                                    }],
                                    dataZoom: [{
                                        //
                                    }],
                                    toolbox: { // 工具栏
                                        feature: {
                                            dataZoom: { // 框选缩放功能
                                                show: true, // show为true时，才能触发takeGlobalCursor事件
                                                yAxisIndex: 'none',
                                            },
                                            restore: {
                                                show: true
                                            },
                                            saveAsImage: {
                                                show: true,
                                                type: 'png',
                                            },
                                        }
                                    }
                                };
                                fig3.setOption(option_envelope);
                                fig3.getZr().on('click', function (params) {
                                    // console.log(params);
                                    let point = [params.offsetX, params.offsetY];
                                    if (fig3.containPixel({seriesIndex: 0}, point)) {
                                        let xIndex = fig3.convertFromPixel({seriesIndex: 0}, point)[0];
                                        let op = fig3.getOption();
                                        // console.log(op);
                                        let allxIndex = op.series[0].data.map((x) => x.value[0]);
                                        let diff = allxIndex.map((x) => Math.abs(x-xIndex));
                                        let closest = Math.min.apply(null, diff);
                                        let idx = diff.indexOf(closest);
                                        let name = op.series[0].data[idx].value[0];
                                        let value = op.series[0].data[idx].value[1];
                                        fig3.dispatchAction({
                                            type: 'showTip',
                                            seriesIndex: 0,//这行不能省
                                            dataIndex: idx
                                        });
                                        document.getElementById('time_info').innerHTML = name + ': ' + value;
                                    }
                                });
                            }
                        });
                    }
                }
            });
        });
	</script>
    <script>
        $(document).ready(function () {
            $("input[name=trend]").click(function () {
                if (fig1.dispose) {
                    fig1.dispose();
                }
                fig1 = echarts.init(document.getElementById('fig1'), 'white', {renderer: 'canvas'});
                if (fig2.dispose) {
                    fig2.dispose();
                }
                fig2 = echarts.init(document.getElementById('fig2'), 'white', {renderer: 'canvas'});
                if (fig3.dispose) {
                    fig3.dispose();
                }
                fig3 = echarts.init(document.getElementById('fig3'), 'white', {renderer: 'canvas'});
                var criterion = $('#criterion').find('option:selected').val();
                var more_wind_turbine = document.getElementById('more_wind_turbine');
                var wind_turbine_selected = [];
                for (let i = 0; i < more_wind_turbine.length; i++) {
                    if (more_wind_turbine.options[i].selected) {
                        wind_turbine_selected.push(more_wind_turbine[i].text)
                    }
                }
                var farm_name = $('#farm').find('option:selected').text();
                var wind_turbine_name = $('#wind_turbine').find('option:selected').text();
                var from_time = $('#from_time').val();
                var to_time = $('#to_time').val();
                var from_rotate_speed = $('#from_rotate_speed').find('option:selected').text();
                var to_rotate_speed = $('#to_rotate_speed').find('option:selected').text();
                var treeObj = $.fn.zTree.getZTreeObj("treeDemo");
                if (farm_name === '选择风场' || wind_turbine_name === '选择风机' || treeObj == null) {
                    alert('请先选择左侧项目！');
                }
                else {
                    // 当前选中节点
                    var sn = treeObj.getSelectedNodes();
                    if (sn.length === 0) {
                        alert('请选择测点！');
                    }
                    else if (sn[0].hasOwnProperty('children') && sn[0].children.length > 0) {
                        alert('请选择子节点！');
                    }
                    else {
                        var dataset = {'farm_name': farm_name,
                            'point': sn[0]['name'],
                            'criterion': criterion,
                            'wind_turbine_selected': JSON.stringify(wind_turbine_selected),
                            'from_time': from_time,
                            'to_time': to_time,
                            'from_rotate_speed': from_rotate_speed,
                            'to_rotate_speed': to_rotate_speed,
                        };
                        $.ajax({
                            url: "/trend",
                            type: "POST",
                            data: dataset,
                            dataType: "json",
                            beforeSend: function () {
                                document.getElementById('loading-image').style.display='';
                            },
                            complete: function () {
                                document.getElementById('loading-image').style.display='none';
                            },
                            success: function (data) {
                                console.log(data['vdi']);
                                var option_ev = {
                                    title: {
                                        text: 'ev图'
                                    },
                                    tooltip: {
                                        trigger: 'axis',
                                        triggerOn: 'mousemove|click',
                                    },
                                    legend: {
                                        data: []
                                    },
                                    xAxis: {
                                        type: 'value',
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    yAxis: {
                                        type: 'value',
                                        boundaryGap: [0, '100%'],
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    series: [],
                                    dataZoom: [{
                                        //
                                    }],
                                    toolbox: { // 工具栏
                                        feature: {
                                            dataZoom: { // 框选缩放功能
                                                show: true, // show为true时，才能触发takeGlobalCursor事件
                                                yAxisIndex: 'none',
                                            },
                                            restore: {
                                                show: true
                                            },
                                            saveAsImage: {
                                                show: true,
                                                type: 'png',
                                            },
                                        }
                                    }
                                };
                                for (let c in wind_turbine_selected) {
                                    option_ev.legend.data.push(wind_turbine_selected[c]);
                                    var ser = {
                                        name: wind_turbine_selected[c],
                                        type: 'scatter',
                                        showSymbol: 8,
                                        hoverAnimation: true,
                                        data: data['vdi'][wind_turbine_selected[c]]['ev'],
                                        markPoint: {
                                            data: [],
                                        }
                                    };
                                    option_ev.series.push(ser);
                                }
                                if (option_ev.series.length !== 0) {
                                    fig1.setOption(option_ev);
                                }
                                fig1.on('click', function (params) {
                                    // console.log(params);
                                    if (params.componentType !== 'series') return;
                                    let [x, y] = params.value;
                                    let op = fig1.getOption();
                                    // console.log(op);
                                    let markPointData = op.series[params.seriesIndex].markPoint.data;
                                    markPointData.push({
                                        name: `x:${x}\ny:${y}`,
                                        coord: params.value,
                                        label: {
                                            show: true,
                                            formatter: `x:${x}\ny:${y}`,
                                            position: 'top'
                                        },
                                        symbolSize: 6,
                                        symbol: 'rect',
                                        itemStyle: {
                                            color: '#000'
                                        }
                                    });
                                    let series = op.series;
                                    series[params.seriesIndex] = {
                                        markPoint: {
                                            data: markPointData
                                        }
                                    };
                                    fig1.setOption({
                                        series: series
                                    });
                                    // document.getElementById('time_info').innerHTML = text;
                                });
                                // addEventListener() 方法用于向指定元素添加事件句柄
                                document.getElementById("fig1").addEventListener('contextmenu', function (e) {
                                    // event.preventDefault() 方法阻止元素发生默认的行为
                                    e.preventDefault();
                                }, false);
                                fig1.on('contextmenu', function (params) {
                                    // console.log(params);
                                    if (params.componentType !== 'markPoint') return;
                                    let op = fig1.getOption();
                                    // console.log(op);
                                    let markPointData = op.series[params.seriesIndex].markPoint.data;
                                    let newMarkPointData = markPointData.filter(({ name }) => name !== params.name);
                                    let series = op.series;
                                    series[params.seriesIndex] = {
                                        markPoint: {
                                            data: newMarkPointData
                                        }
                                    };
                                    fig1.setOption({
                                        series: series
                                    });
                                });
                                var option_ev2 = {
                                    title: {
                                        text: 'ev图'
                                    },
                                    tooltip: {
                                        trigger: 'axis',
                                        triggerOn: 'mousemove|click',
                                    },
                                    xAxis: {
                                        type: 'value',
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    yAxis: {
                                        type: 'value',
                                        boundaryGap: [0, '100%'],
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    series: [{
                                        name: 'ev信号',
                                        type: 'line',
                                        lineStyle: {
                                            width: 1
                                        },
                                        showSymbol: false,
                                        hoverAnimation: true,
                                        data: data['ev']
                                    }],
                                    dataZoom: [{
                                        //
                                    }],
                                    toolbox: { // 工具栏
                                        feature: {
                                            dataZoom: { // 框选缩放功能
                                                show: true, // show为true时，才能触发takeGlobalCursor事件
                                                yAxisIndex: 'none',
                                            },
                                            restore: {
                                                show: true
                                            },
                                            saveAsImage: {
                                                show: true,
                                                type: 'png',
                                            },
                                        }
                                    }
                                };
                                fig2.setOption(option_ev2);
                                var option_iv = {
                                    title: {
                                        text: 'iv图'
                                    },
                                    tooltip: {
                                        trigger: 'axis',
                                        triggerOn: 'mousemove|click',
                                    },
                                    xAxis: {
                                        type: 'value',
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    yAxis: {
                                        type: 'value',
                                        boundaryGap: [0, '100%'],
                                        splitLine: {
                                            show: false
                                        }
                                    },
                                    series: [{
                                        name: 'iv',
                                        type: 'line',
                                        lineStyle: {
                                            width: 1
                                        },
                                        showSymbol: false,
                                        hoverAnimation: true,
                                        data: data['iv']
                                    }],
                                    dataZoom: [{
                                        //
                                    }],
                                    toolbox: { // 工具栏
                                        feature: {
                                            dataZoom: { // 框选缩放功能
                                                show: true, // show为true时，才能触发takeGlobalCursor事件
                                                yAxisIndex: 'none',
                                            },
                                            restore: {
                                                show: true
                                            },
                                            saveAsImage: {
                                                show: true,
                                                type: 'png',
                                            },
                                        }
                                    }
                                };
                                fig3.setOption(option_iv);
                            }
                        });
                    }
                }
            });
        });
    </script>
    <script>
        $(function () {
            let Btn = $("input[name=spectrum_envelope]");
            let Btn2 = $("input[name=trend_analysis]");
            let Pop = $('#pop');
            let Pop2 = $('#pop2');
            let PopCon = $('.pop_con');

            Btn.click(function () {
                Pop.fadeIn();
                return false;
            });
            Btn2.click(function () {
                let wind_turbine = $('#wind_turbine option');
                let wt = wind_turbine.map(function () {return $(this).text();});
                let more_wind_turbine = document.getElementById('more_wind_turbine');
                // 默认清空已经存在的项目
                $("#more_wind_turbine").empty();
                for (let i=0; i < wt.length; i++) {
                    more_wind_turbine.options.add(new Option(wt[i], i+1));
                }
                Pop2.fadeIn();
                return false;
            });
            $(window).click(function () {
                Pop.fadeOut();
                Pop2.fadeOut();
            });
            PopCon.click(function () {
                return false;
            });
            $('#envelope').click(function () {
                Pop.fadeOut();
            });
            $('#trend').click(function () {
                Pop2.fadeOut();
            });
        });
    </script>
    <script>
        window.onresize = function () {
            if (fig1.dispose && fig2.dispose) {
                let chartsArr = [];

                chartsArr.push(fig1);
                chartsArr.push(fig2);

                for (let i = 0; i < chartsArr.length; i++) {
                    // ECharts随窗口大小改变而自适应
                    chartsArr[i].resize();
                }
            }
            if (fig3.dispose) {
                // ECharts随窗口大小改变而自适应
                fig3.resize();
            }
        }
    </script>
</head>
<body>
    <div class="left">
        <div class="logo"><img src="http://www.bj-nego.com/res/tpl/default/images/icon/logo.jpg" alt=""></div>
        <div class="query">
            <label for="farm"> 风 场 </label>
            <select id="farm" name="farm">
                <option value="0">选择风场</option>
            </select>
            <br/>
            <label for="wind_turbine" > 风 机 </label>
            <select id="wind_turbine" name="wind_turbine">
                <option value="0">选择风机</option>
            </select>
            <br/>
            <div class="layui-inline">
                <label class="layui-form-label">起始时间</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" id="from_time" placeholder="yyyyMMddHHmmss">
                </div>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label">结束时间</label>
                <div class="layui-input-inline">
                    <input type="text" class="layui-input" id="to_time" placeholder="yyyyMMddHHmmss">
                </div>
            </div>
            <br/>
            <label for="from_rotate_speed">转速 From</label>
            <select id="from_rotate_speed" name="from_rotate_speed">
                <option value="0">选择转速</option>
                <option value="1" selected="selected">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
            </select>
            <br/>
            <label for="to_rotate_speed">转速 To</label>
            <select id="to_rotate_speed" name="to_rotate_speed">
                <option value="0">选择转速</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20" selected="selected">20</option>
            </select>
            <br/>
            <input type="submit" value="查询" id="q" name="q">
        </div>
        <div id="time_info"></div>
        <div id="treeDemo" class="ztree">加载中...</div>
    </div>
    <div class="middle">
        <div class="toolbar">
            <input type="submit" value="时域图和频域图" id="toolbar1" name="tf">
            <input type="submit" value="频谱包络图" id="toolbar2" name="spectrum_envelope">
            <input type="submit" value="趋势图" id="toolbar3" name="trend_analysis">
            <div id="pop" class="pop_main">
                <div id="con" class="pop_con">
                    <input type="text" id="low_cutoff" name="low_cutoff" placeholder="请输入低截止频率">
                    <input type="text" id="high_cutoff" name="high_cutoff" placeholder="请输入高截止频率">
                    <input type="submit" value="绘图" id="envelope" name="envelope">
                </div>
                <div class="mask"></div>
            </div>
            <div id="pop2" class="pop_main">
                <div id="con2" class="pop_con">
                    <label for="criterion"> 标 准 </label>
                    <select id="criterion" name="criterion">
                        <option value="1">VDI</option>
                        <option value="2">无量纲</option>
                    </select>
                    <br/>
                    <label for="more_wind_turbine"> 风 机 </label>
                    <select id="more_wind_turbine" name="more_wind_turbine" multiple="multiple" size="5">
                    </select>
                    <input type="submit" value="绘图" id="trend" name="trend">
                </div>
                <div class="mask"></div>
            </div>
        </div>
        <div class="figure">
            <div id="loading-image" class="loading">加载中...</div>
            <div id="fig1"></div>
            <div id="fig2"></div>
            <div id="fig3"></div>
        </div>
    </div>
    <div class="right">
        <div id="farm_info" class="info">风场信息</div>
        <div id="wind_turbine_info" class="info">风机信息</div>
        <div id="fault_history" class="info">故障历史</div>
    </div>
</body>
</html>