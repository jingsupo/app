<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>预览</title>
    <style>
        .img {
            height: 320px;
        }

        input {
            width: 135px;
        }
    </style>
    <script src="static/js/jquery-1.4.4.min.js"></script>
    <script>
        function setValue (data) {
            // 设置页面标题
            document.title = data['point_name'];

            // 设置页面内容
            $('#farm').val(data['farm_name']);
            $('#wind_turbine').val(data['wind_turbine_name']);
            $('#point_name').val(data['point_name']);
            $('#record_time').val(data['record_time']);
            $('#sampling_time').val(data['sampling_time']);
            $('#analyst').val(data['analyst']);
            $('#ts').html(data['ts']);
            $('#freq').html(data['freq']);
            $('#env').html(data['env']);
            $('#trend').html(data['trend']);
            $('#level').html(data['level']);
            $('#img_t').attr('src', data['img_t']);
            $('#img_f').attr('src', data['img_f']);
            $('#img_e').attr('src', data['img_e']);
            $('#img_1').attr('src', data['img_1']);
            $('#img_2').attr('src', data['img_2']);
            $('#img_3').attr('src', data['img_3']);
            $('#img_4').attr('src', data['img_4']);
            if (data['img_t'] === null) {
                $('#p_img_t').hide();
            }
            if (data['img_f'] === null) {
                $('#p_img_f').hide();
            }
            if (data['img_e'] === null) {
                $('#p_img_e').hide();
            }
            if (data['img_1'] === null) {
                $('#p_img_1').hide();
            }
            if (data['img_2'] === null) {
                $('#p_img_2').hide();
            }
            if (data['img_3'] === null) {
                $('#p_img_3').hide();
            }
            if (data['img_4'] === null) {
                $('#p_img_4').hide();
            }
            // 当把图片保存到磁盘，并用图片的磁盘路径作为img的src属性时，启用以下代码
            // let preview_path = "{{ url_for('static', filename='temp/preview/') }}";
            // $('#img_t').attr('src', preview_path+data['img_t_name']);
            // $('#img_f').attr('src', preview_path+data['img_f_name']);
            // $('#img_e').attr('src', preview_path+data['img_e_name']);
        }

        // 调用父页面的函数
        let data = window.opener.getPreviewData();

        $(document).ready(function () {
            setValue(data);
        });
    </script>
</head>
<body>
    <div>
        <p>
            <label for="farm"><strong>风场：</strong></label>
            <input type="text" readonly="readonly" id="farm">
            <label for="wind_turbine"><strong>风机：</strong></label>
            <input type="text" readonly="readonly" id="wind_turbine">
            <label for="point_name"><strong>测点名称：</strong></label>
            <input type="text" readonly="readonly" id="point_name">
        </p>
        <p>
            <label for="record_time"><strong>记录时间：</strong></label>
            <input type="text" readonly="readonly" id="record_time">
            <label for="sampling_time"><strong>采样时间：</strong></label>
            <input type="text" readonly="readonly" id="sampling_time">
            <label for="analyst"><strong>分析师：</strong></label>
            <input type="text" readonly="readonly" id="analyst">
        </p>
        <p id="p_img_t"><img alt="" class="img" id="img_t" src="" /></p>
        <strong>时域分析结果：</strong>
        <p id="ts"></p>
        <p id="p_img_f"><img alt="" class="img" id="img_f" src="" /></p>
        <strong>频域分析结果：</strong>
        <p id="freq"></p>
        <p id="p_img_e"><img alt="" class="img" id="img_e" src="" /></p>
        <strong>包络分析结果：</strong>
        <p id="env"></p>
        <p id="p_img_1"><img alt="" class="img" id="img_1" src="" /></p>
        <p id="p_img_2"><img alt="" class="img" id="img_2" src="" /></p>
        <p id="p_img_3"><img alt="" class="img" id="img_3" src="" /></p>
        <p id="p_img_4"><img alt="" class="img" id="img_4" src="" /></p>
        <strong>趋势分析结果：</strong>
        <p id="trend"></p>
        <strong>故障级别：</strong>
        <p id="level"></p>
    </div>
</body>
</html>